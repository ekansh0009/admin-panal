<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PAPI Admin Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f3f4f6;
      color: #0f172a;
      min-height: 100vh;
      display: flex;
    }

    /* Sidebar */
    .sidebar {
      width: 240px;
      background: #0f172a;
      color: #e5e7eb;
      padding: 18px 16px;
      display: flex;
      flex-direction: column;
    }

    .sidebar-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 24px;
    }

    .logo-circle {
      width: 34px;
      height: 34px;
      border-radius: 999px;
      background: #4c6fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 18px;
    }

    .sidebar-title {
      font-weight: 700;
      font-size: 18px;
    }

    .sidebar-sub {
      font-size: 11px;
      color: #9ca3af;
    }

    .nav {
      list-style: none;
      margin-top: 12px;
    }

    .nav-item {
      margin-bottom: 4px;
    }

    .nav-link {
      width: 100%;
      border-radius: 10px;
      padding: 8px 10px;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      font-size: 14px;
      color: #e5e7eb;
      border: none;
      background: transparent;
      text-align: left;
      transition: background 0.15s ease, color 0.15s ease;
    }

    .nav-link span.icon {
      font-size: 16px;
      width: 18px;
      text-align: center;
    }

    .nav-link.active,
    .nav-link:hover {
      background: #111827;
      color: #ffffff;
    }

    .sidebar-footer {
      margin-top: auto;
      font-size: 12px;
      color: #6b7280;
    }

    /* Main content */
    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-width: 0;
    }

    .topbar {
      height: 56px;
      background: #ffffff;
      border-bottom: 1px solid #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
    }

    .topbar-title {
      font-weight: 600;
      font-size: 16px;
    }

    .topbar-right {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 13px;
      color: #6b7280;
    }

    .avatar {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: #4c6fff;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: 600;
    }

    .logout-btn {
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      padding: 6px 10px;
      background: #ffffff;
      color: #374151;
      font-size: 12px;
      cursor: pointer;
    }

    .content {
      padding: 18px 20px 24px;
      min-height: calc(100vh - 56px);
    }

    .section {
      display: none;
    }

    .section.active {
      display: block;
    }

    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .section-title {
      font-size: 20px;
      font-weight: 700;
    }

    .btn-primary {
      border-radius: 10px;
      border: none;
      padding: 8px 14px;
      background: #4c6fff;
      color: #ffffff;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .btn-secondary {
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      padding: 6px 10px;
      background: #ffffff;
      color: #374151;
      font-size: 12px;
      cursor: pointer;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 14px;
      margin-bottom: 18px;
    }

    .card {
      background: #ffffff;
      border-radius: 14px;
      padding: 14px;
      border: 1px solid #e5e7eb;
    }

    .card-title {
      font-size: 13px;
      color: #6b7280;
      margin-bottom: 4px;
    }

    .card-value {
      font-size: 18px;
      font-weight: 700;
    }

    .card-sub {
      font-size: 11px;
      color: #9ca3af;
      margin-top: 4px;
    }

    /* Table */
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
      background: #ffffff;
      border-radius: 14px;
      overflow: hidden;
      border: 1px solid #e5e7eb;
    }

    thead {
      background: #f9fafb;
    }

    th,
    td {
      padding: 10px 12px;
      text-align: left;
      border-bottom: 1px solid #e5e7eb;
    }

    th {
      font-size: 12px;
      font-weight: 600;
      color: #6b7280;
    }

    tr:last-child td {
      border-bottom: none;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      font-weight: 600;
    }

    .badge-free {
      background: #e0f2fe;
      color: #0369a1;
    }

    .badge-paid {
      background: #fef3c7;
      color: #b45309;
    }

    .muted {
      font-size: 12px;
      color: #9ca3af;
      margin-top: 8px;
    }

    .inline-form {
      margin-top: 14px;
      background: #ffffff;
      border-radius: 14px;
      border: 1px solid #e5e7eb;
      padding: 12px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .inline-input {
      flex: 1 1 180px;
      min-width: 0;
    }

    .inline-input input,
    .inline-input select {
      width: 100%;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      padding: 7px 9px;
      font-size: 13px;
    }

    /* Loading overlay */
    #overlay {
      position: fixed;
      inset: 0;
      background: rgba(243, 244, 246, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 50;
      font-size: 14px;
      color: #6b7280;
    }

    @media (max-width: 900px) {
      .sidebar {
        display: none;
      }

      body {
        flex-direction: column;
      }

      .main {
        width: 100%;
      }

      .grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (max-width: 640px) {
      .grid {
        grid-template-columns: 1fr;
      }

      .inline-form {
        flex-direction: column;
        align-items: stretch;
      }
    }
  </style>
</head>
<body>
  <div id="overlay">Checking admin access‚Ä¶</div>

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo-circle">P</div>
      <div>
        <div class="sidebar-title">PAPI Admin</div>
        <div class="sidebar-sub">Control panel</div>
      </div>
    </div>

    <ul class="nav">
      <li class="nav-item">
        <button class="nav-link active" data-section="overview">
          <span class="icon">üè†</span> Dashboard
        </button>
      </li>
      <li class="nav-item">
        <button class="nav-link" data-section="courses">
          <span class="icon">üìö</span> Courses
        </button>
      </li>
      <li class="nav-item">
        <button class="nav-link" data-section="tests">
          <span class="icon">üìù</span> Tests
        </button>
      </li>
      <li class="nav-item">
        <button class="nav-link" data-section="updates">
          <span class="icon">üì¢</span> Updates
        </button>
      </li>
      <li class="nav-item">
        <button class="nav-link" data-section="settings">
          <span class="icon">‚öôÔ∏è</span> Settings
        </button>
      </li>
    </ul>

    <div class="sidebar-footer">
      ¬© PAPI ‚Ä¢ v0.1<br />
      (Backend jald hi connect hoga)
    </div>
  </aside>

  <!-- MAIN AREA -->
  <div class="main">
    <header class="topbar">
      <div class="topbar-title">PAPI Admin Panel</div>
      <div class="topbar-right">
        <span id="adminEmail">Admin</span>
        <div class="avatar" id="avatarInitial">A</div>
        <button class="logout-btn" id="logoutBtn">Logout</button>
      </div>
    </header>

    <main class="content">
      <!-- Overview -->
      <section class="section active" id="section-overview">
        <div class="section-header">
          <h2 class="section-title">Overview</h2>
        </div>

        <div class="grid">
          <div class="card">
            <div class="card-title">Total Courses</div>
            <div class="card-value" id="stat-courses">2</div>
            <div class="card-sub">Free + paid</div>
          </div>
          <div class="card">
            <div class="card-title">Total Tests</div>
            <div class="card-value" id="stat-tests">3</div>
            <div class="card-sub">Active test series</div>
          </div>
          <div class="card">
            <div class="card-title">Last Update</div>
            <div class="card-value">Today</div>
            <div class="card-sub">Dummy data for now</div>
          </div>
        </div>

        <p class="muted">
          Ye sirf UI hai. Backend add hone ke baad ye stats database se aayenge.
        </p>
      </section>

      <!-- Courses -->
      <section class="section" id="section-courses">
        <div class="section-header">
          <h2 class="section-title">Courses</h2>
          <button class="btn-primary" id="addCourseBtn">+ Quick add</button>
        </div>

        <table id="coursesTable">
          <thead>
            <tr>
              <th>#</th>
              <th>Title</th>
              <th>Level</th>
              <th>Type</th>
              <th>Price</th>
              <th style="width: 120px;">Actions</th>
            </tr>
          </thead>
          <tbody>
            <!-- Dummy rows -->
            <tr>
              <td>1</td>
              <td>Physics Crash Course</td>
              <td>Class 11</td>
              <td><span class="badge badge-free">Free</span></td>
              <td>‚Çπ0</td>
              <td>
                <button class="btn-secondary">Edit</button>
                <button class="btn-secondary">Delete</button>
              </td>
            </tr>
            <tr>
              <td>2</td>
              <td>Complete Maths Booster</td>
              <td>Class 12</td>
              <td><span class="badge badge-paid">Paid</span></td>
              <td>‚Çπ999</td>
              <td>
                <button class="btn-secondary">Edit</button>
                <button class="btn-secondary">Delete</button>
              </td>
            </tr>
          </tbody>
        </table>

        <form class="inline-form" id="courseForm">
          <div class="inline-input">
            <input type="text" id="courseTitle" placeholder="Course title" required />
          </div>
          <div class="inline-input">
            <input type="text" id="courseLevel" placeholder="Level (e.g. Class 11)" />
          </div>
          <div class="inline-input">
            <select id="courseType">
              <option value="free">Free</option>
              <option value="paid">Paid</option>
            </select>
          </div>
          <div class="inline-input">
            <input type="number" id="coursePrice" placeholder="Price (‚Çπ)" min="0" />
          </div>
          <button type="submit" class="btn-primary">Save to table</button>
        </form>

        <p class="muted">
          Filhaal ye form sirf table me row add karta hai (frontend). Backend ke baad yahi DB me save karega.
        </p>
      </section>

      <!-- Tests -->
      <section class="section" id="section-tests">
        <div class="section-header">
          <h2 class="section-title">Tests</h2>
          <button class="btn-primary">+ New test</button>
        </div>

        <table>
          <thead>
            <tr>
              <th>#</th>
              <th>Test Name</th>
              <th>Course</th>
              <th>Questions</th>
              <th>Duration</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>1</td>
              <td>JEE Mock Test 01</td>
              <td>Physics Crash Course</td>
              <td>25</td>
              <td>60 min</td>
              <td><span class="badge badge-free">Free</span></td>
            </tr>
            <tr>
              <td>2</td>
              <td>NEET Practice Set</td>
              <td>Complete Biology</td>
              <td>50</td>
              <td>90 min</td>
              <td><span class="badge badge-paid">Premium</span></td>
            </tr>
          </tbody>
        </table>

        <p class="muted">
          Baad me yahan test create/edit/delete ke proper forms banayenge.
        </p>
      </section>

      <!-- Updates -->
      <section class="section" id="section-updates">
        <div class="section-header">
          <h2 class="section-title">Updates</h2>
          <button class="btn-primary">+ New update</button>
        </div>

        <table>
          <thead>
            <tr>
              <th>#</th>
              <th>Title</th>
              <th>Visible to</th>
              <th>Created at</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>1</td>
              <td>New Chemistry batch starting next week</td>
              <td>All students</td>
              <td>Today</td>
            </tr>
            <tr>
              <td>2</td>
              <td>New free mock tests added for JEE</td>
              <td>JEE students</td>
              <td>Yesterday</td>
            </tr>
          </tbody>
        </table>

        <p class="muted">
          Backend ke saath ye updates API se PAPI app tak jaayengi.
        </p>
      </section>

      <!-- Settings -->
      <section class="section" id="section-settings">
        <div class="section-header">
          <h2 class="section-title">Settings</h2>
        </div>
        <div class="card">
          <div class="card-title">Admin Settings (placeholder)</div>
          <p class="muted">
            Yahan baad me admin logins, app config, ads settings, etc. rakhenge.
          </p>
        </div>
      </section>
    </main>
  </div>

  <script>
    // Same Firebase config yahan bhi
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    const ALLOWED_ADMINS = [
      "admin@papi.in" // yahi email login kar sakega
    ];

    const overlay = document.getElementById('overlay');
    const adminEmailSpan = document.getElementById('adminEmail');
    const avatarInitial = document.getElementById('avatarInitial');
    const logoutBtn = document.getElementById('logoutBtn');

    auth.onAuthStateChanged((user) => {
      if (!user || !user.email || !ALLOWED_ADMINS.includes(user.email)) {
        // Not authorized ‚Üí logout + redirect
        if (user) auth.signOut();
        window.location.href = 'index.html';
      } else {
        // Authorized admin
        adminEmailSpan.textContent = user.email;
        const initial = user.email.charAt(0).toUpperCase();
        avatarInitial.textContent = initial;
        overlay.style.display = 'none';
      }
    });

    logoutBtn.addEventListener('click', async () => {
      await auth.signOut();
      window.location.href = 'index.html';
    });

    // Sidebar navigation
    const navLinks = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('.section');

    navLinks.forEach((link) => {
      link.addEventListener('click', () => {
        const target = link.getAttribute('data-section');

        navLinks.forEach((l) => l.classList.remove('active'));
        link.classList.add('active');

        sections.forEach((sec) => {
          if (sec.id === 'section-' + target) {
            sec.classList.add('active');
          } else {
            sec.classList.remove('active');
          }
        });
      });
    });

    // Courses quick-add form (frontend only)
    const courseForm = document.getElementById('courseForm');
    const coursesTableBody = document.querySelector('#coursesTable tbody');
    const statCourses = document.getElementById('stat-courses');

    function updateCourseCount() {
      const rows = coursesTableBody.querySelectorAll('tr').length;
      statCourses.textContent = rows.toString();
    }

    updateCourseCount();

    courseForm.addEventListener('submit', function (e) {
      e.preventDefault();

      const title = document.getElementById('courseTitle').value.trim();
      const level = document.getElementById('courseLevel').value.trim();
      const type = document.getElementById('courseType').value;
      const priceInput = document.getElementById('coursePrice').value.trim();

      if (!title) return;

      const isFree = type === 'free';
      const price = priceInput === '' ? (isFree ? 0 : 0) : Number(priceInput);

      const rowCount = coursesTableBody.querySelectorAll('tr').length;
      const newRow = document.createElement('tr');

      newRow.innerHTML = `
        <td>${rowCount + 1}</td>
        <td>${title}</td>
        <td>${level || '-'}</td>
        <td>
          <span class="badge ${isFree ? 'badge-free' : 'badge-paid'}">
            ${isFree ? 'Free' : 'Paid'}
          </span>
        </td>
        <td>‚Çπ${price}</td>
        <td>
          <button class="btn-secondary">Edit</button>
          <button class="btn-secondary">Delete</button>
        </td>
      `;

      coursesTableBody.appendChild(newRow);
      courseForm.reset();
      updateCourseCount();
    });
  </script>
</body>
</html>
